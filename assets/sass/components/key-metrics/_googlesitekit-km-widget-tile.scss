/**
 * Key metric widget tile styles.
 *
 * Site Kit by Google, Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

.googlesitekit-plugin {

	.googlesitekit-km-widget-tile {
		display: flex;
		flex-direction: column;
		justify-content: space-between;
		padding: 12px $grid-gap-phone;

		@media (min-width: $bp-nonMobile) {
			min-height: 150px;
			padding: 18px 24px;
		}

		.googlesitekit-km-widget-tile__title-container {
			display: flex;
			flex-basis: 50%;
			flex-grow: 1;
		}

		.googlesitekit-km-widget-tile__title {
			color: $c-neutral-n-500;
			flex: 1;
			font-family: $f-primary;
			font-size: $fs-label-sm;
			font-weight: $fw-normal;
			letter-spacing: $ls-xs;
			line-height: 16px;
			margin: 0 8px 4px 0;
		}

		.googlesitekit-km-widget-tile__body {
			display: flex;
			flex-basis: 50%;
			flex-grow: 1;

			@media (min-width: $bp-nonMobile) {
				flex-direction: column;
			}
		}

		.googlesitekit-km-widget-tile__metric-container {
			flex-basis: 100%;
		}

		.googlesitekit-km-widget-tile__metric-change-container {
			align-self: flex-end;
			display: flex;

			@media (min-width: $bp-nonMobile) {
				align-self: auto;
			}
		}
	}

	.googlesitekit-km-widget-tile--numeric {

		.googlesitekit-km-widget-tile__metric {
			font-family: $f-secondary;
			font-size: $fs-headline-lg;
			line-height: $lh-headline-lg;
			margin-top: 4px;

			@media (min-width: $bp-nonMobile) {
				margin: 0;
			}
		}

		.googlesitekit-km-widget-tile__subtext {
			font-size: $fs-label-sm;
			font-weight: $fw-medium;
			line-height: $lh-label-sm;
			margin: -1px 0 1px;

			@media (min-width: $bp-nonMobile) {
				font-size: $fs-label-md;
				font-weight: $fw-normal;
				line-height: $lh-label-md;
				margin: -4px 0 1px;
			}
		}
	}

	.googlesitekit-km-widget-tile--text {

		.googlesitekit-km-widget-tile__metric {
			font-size: $fs-title-lg;
			font-weight: 500;
			margin-top: 4px;

			@media (min-width: $bp-nonMobile) {
				margin: 5px 0 0;
			}
		}

		.googlesitekit-km-widget-tile__subtext {
			font-size: $fs-label-sm;
			font-weight: $fw-medium;
			line-height: $lh-label-sm;
			margin: 2px 0 0;

			@media (min-width: $bp-nonMobile) {
				font-size: $fs-label-md;
				font-weight: $fw-normal;
				line-height: $lh-label-md;
				margin: 0;
			}
		}
	}

	.googlesitekit-km-widget-tile--table {

		.googlesitekit-km-widget-tile__table {
			display: flex;
			flex-direction: column;
			font-size: $fs-label-sm;
			margin-top: 12px;
			width: 100%;
		}

		.googlesitekit-table__body-row {
			display: flex;
			flex-direction: row;
			justify-content: space-between;
			padding: 2px 0;
		}

		.googlesitekit-table__body-item {
			margin-right: 10px;
			overflow: hidden;
			text-overflow: ellipsis;
			white-space: nowrap;

			&:last-child {
				margin-right: 0;
				overflow: visible;
				text-overflow: unset;
			}

			strong {
				font-weight: $fw-medium;
			}

			.googlesitekit-cta-link {
				display: inline;
			}
		}

		.googlesitekit-km-widget-tile__table-plain-text {
			color: $c-surfaces-on-surface;
			font-size: $fs-body-sm;
			letter-spacing: $ls-xs;
			line-height: $lh-body-sm;
			margin: 0;
			overflow: hidden;
			text-overflow: ellipsis;
		}

		.googlesitekit-table__body-zero-data {
			font-size: $fs-body-md;
			line-height: $lh-body-md;
		}
	}

	.googlesitekit-km-widget-tile__loading {
		width: 100%;

		.googlesitekit-km-widget-tile__loading-body {
			margin-top: 10px;
		}
	}

	// Styles for KMW tile error state.
	.googlesitekit-km-widget-tile--error {
		height: 100%;

		.googlesitekit-cta--error {
			background: $c-white;
			border: 2px solid $c-utility-on-error-container;

			padding: 14px;

			@media (min-width: $bp-nonMobile) {
				min-height: 150px;
				padding: 16px 22px;
			}

			.googlesitekit-cta__header {
				column-gap: $grid-gap-phone / 2;
				display: flex;
				flex-basis: 50%;
			}

			.googlesitekit-cta__header_text {
				color: $c-neutral-n-500;
				font-family: $f-primary;
				font-size: $fs-label-sm;
				font-weight: $fw-normal;
				letter-spacing: $ls-xs;
				margin: 0 0 10px;
			}

			.googlesitekit-cta__title {
				color: $c-neutral-n-900;
				font-family: $f-primary;
				font-size: 18px;
				font-weight: $fw-normal;
			}

			// Required for correct order of button and text elements.
			.googlesitekit-report-error-actions {
				align-items: flex-start;
				display: flex;
				flex-direction: row-reverse;
				gap: 0;

				@media (min-width: $bp-nonMobile) {
					flex-direction: column-reverse;
				}

				.googlesitekit-error-retry-text {
					color: $c-neutral-n-900;
					flex: 1;
					margin: 0;
					margin-right: 14px;

					@media (min-width: $bp-nonMobile) {
						margin-right: 0;
					}
				}

				button:not(.googlesitekit-cta-link),
				a.mdc-button {
					align-self: flex-end;
					font-weight: $fw-medium;
					min-height: 32px;
					padding: 6px 16px;

					@media (min-width: $bp-nonMobile) {
						align-self: flex-start;
						margin-top: 10px;
					}
				}

				.googlesitekit-cta-link {
					color: $c-teal-t-500;
				}
			}
		}
	}

	// Align the title and body of the widgets using subgrid.
	.googlesitekit-widget-area--mainDashboardKeyMetricsPrimary .googlesitekit-widget-area-widgets {

		.mdc-layout-grid__inner {

			@media (min-width: $bp-tablet) {
				grid-template-rows: auto 1fr auto auto 1fr auto;
			}

			@media (min-width: $bp-desktop) {
				grid-template-rows: auto 1fr auto;
			}
		}

		.mdc-layout-grid__cell {
			@media (min-width: $bp-tablet) {
				display: grid;
				grid-row: span 3;
				grid-template-columns: subgrid;
				grid-template-rows: subgrid;
			}

			@media (min-width: $bp-desktop) {
				grid-row: 1 / -1;
			}
		}

		.googlesitekit-widget__body,
		.googlesitekit-widget {
			@media (min-width: $bp-tablet) {
				display: grid;
				grid-column: 1 / -1;
				grid-row: 1 / -1;
				grid-template-columns: subgrid;
				grid-template-rows: subgrid;
			}
		}

		.googlesitekit-cta--error,
		.googlesitekit-km-widget-tile--error {
			@media (min-width: $bp-tablet) {
				display: grid;
				grid-column: 1 / -1;
				grid-row: 1 / -1;

				grid-template-rows: subgrid;
			}
		}

		.googlesitekit-km-widget-tile {
			@media (min-width: $bp-tablet) {
				display: grid;
				gap: 0;
				grid-column: 1 / -1;
				grid-row: 1 / -1;
				grid-template-columns: subgrid;
				grid-template-rows: subgrid;
			}
		}

		.googlesitekit-widget--connectModuleCTATile,
		.googlesitekit-widget--addMetricCTATile .googlesitekit-km-add-metric-cta-tile {
			@media (min-width: $bp-tablet) {
				grid-column: 1 / -1;
				grid-row: 1 / -1;
			}
		}

		.googlesitekit-km-widget-tile > div {
			@media (min-width: $bp-tablet) {
				grid-column: 1 / -1;
			}
		}

		.googlesitekit-cta--error > div,
		.googlesitekit-cta--error > h3 {
			@media (min-width: $bp-tablet) {
				grid-column: 1 / -1;
			}
		}

		.googlesitekit-widget--keyMetricsConnectGA4All,
		.googlesitekit-widget--keyMetricsSetupCTA {
			grid-template-columns: auto;
			grid-template-rows: auto;

			.mdc-layout-grid__inner {

				@media (min-width: $bp-tablet) {
					grid-template-rows: auto;
				}
			}

			.mdc-layout-grid__cell {
				@media (min-width: $bp-tablet) {
					grid-template-columns: auto;
					grid-template-rows: auto;
				}
			}

			.googlesitekit-widget__body {
				@media (min-width: $bp-tablet) {
					display: block;
				}
			}
		}

		// Reduce the size of the module disconnected Maybe Later CTA.
		.mdc-layout-grid__inner.googlesitekit-widget-key-metrics-footer {
			display: inline-block;
		}
	}
}
